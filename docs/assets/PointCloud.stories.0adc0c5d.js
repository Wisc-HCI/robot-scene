import{r as L0}from"./index.7f7b9823.js";import{_ as w,S as E0,l as T0,u as C0,E as A0,a as B0,M as D0}from"./ErrorFallback.4b00d79e.js";import{j as S0}from"./client.c582ae78.js";import"./_commonjsHelpers.712cc82f.js";import"./inheritsLoose.b8ebfe26.js";class X0{constructor(D=Math){w(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),w(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),w(this,"p",[]),w(this,"perm",[]),w(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),w(this,"dot",(t,o,i)=>t[0]*o+t[1]*i),w(this,"dot3",(t,o,i,d)=>t[0]*o+t[1]*i+t[2]*d),w(this,"dot4",(t,o,i,d,m)=>t[0]*o+t[1]*i+t[2]*d+t[3]*m),w(this,"noise",(t,o)=>{let i,d,m;const c=.5*(Math.sqrt(3)-1),s=(t+o)*c,X=Math.floor(t+s),e=Math.floor(o+s),j=(3-Math.sqrt(3))/6,b=(X+e)*j,E=X-b,u=e-b,M=t-E,S=o-u;let F=0,P=1;M>S&&(F=1,P=0);const p=M-F+j,f=S-P+j,h=M-1+2*j,x=S-1+2*j,k=X&255,y=e&255,v=this.perm[k+this.perm[y]]%12,n=this.perm[k+F+this.perm[y+P]]%12,r=this.perm[k+1+this.perm[y+1]]%12;let l=.5-M*M-S*S;l<0?i=0:(l*=l,i=l*l*this.dot(this.grad3[v],M,S));let a=.5-p*p-f*f;a<0?d=0:(a*=a,d=a*a*this.dot(this.grad3[n],p,f));let C=.5-h*h-x*x;return C<0?m=0:(C*=C,m=C*C*this.dot(this.grad3[r],h,x)),70*(i+d+m)}),w(this,"noise3d",(t,o,i)=>{let d,m,c,s;const X=.3333333333333333,e=(t+o+i)*X,j=Math.floor(t+e),b=Math.floor(o+e),E=Math.floor(i+e),u=1/6,M=(j+b+E)*u,S=j-M,F=b-M,P=E-M,p=t-S,f=o-F,h=i-P;let x,k,y,v,n,r;p>=f?f>=h?(x=1,k=0,y=0,v=1,n=1,r=0):p>=h?(x=1,k=0,y=0,v=1,n=0,r=1):(x=0,k=0,y=1,v=1,n=0,r=1):f<h?(x=0,k=0,y=1,v=0,n=1,r=1):p<h?(x=0,k=1,y=0,v=0,n=1,r=1):(x=0,k=1,y=0,v=1,n=1,r=0);const l=p-x+u,a=f-k+u,C=h-y+u,Y=p-v+2*u,N=f-n+2*u,Z=h-r+2*u,O=p-1+3*u,W=f-1+3*u,g=h-1+3*u,T=j&255,A=b&255,B=E&255,H=this.perm[T+this.perm[A+this.perm[B]]]%12,I=this.perm[T+x+this.perm[A+k+this.perm[B+y]]]%12,J=this.perm[T+v+this.perm[A+n+this.perm[B+r]]]%12,K=this.perm[T+1+this.perm[A+1+this.perm[B+1]]]%12;let _=.6-p*p-f*f-h*h;_<0?d=0:(_*=_,d=_*_*this.dot3(this.grad3[H],p,f,h));let q=.6-l*l-a*a-C*C;q<0?m=0:(q*=q,m=q*q*this.dot3(this.grad3[I],l,a,C));let G=.6-Y*Y-N*N-Z*Z;G<0?c=0:(G*=G,c=G*G*this.dot3(this.grad3[J],Y,N,Z));let L=.6-O*O-W*W-g*g;return L<0?s=0:(L*=L,s=L*L*this.dot3(this.grad3[K],O,W,g)),32*(d+m+c+s)}),w(this,"noise4d",(t,o,i,d)=>{const m=this.grad4,c=this.simplex,s=this.perm,X=(Math.sqrt(5)-1)/4,e=(5-Math.sqrt(5))/20;let j,b,E,u,M;const S=(t+o+i+d)*X,F=Math.floor(t+S),P=Math.floor(o+S),p=Math.floor(i+S),f=Math.floor(d+S),h=(F+P+p+f)*e,x=F-h,k=P-h,y=p-h,v=f-h,n=t-x,r=o-k,l=i-y,a=d-v,C=n>r?32:0,Y=n>l?16:0,N=r>l?8:0,Z=n>a?4:0,O=r>a?2:0,W=l>a?1:0,g=C+Y+N+Z+O+W;let T,A,B,H,I,J,K,_,q,G,L,r0;T=c[g][0]>=3?1:0,A=c[g][1]>=3?1:0,B=c[g][2]>=3?1:0,H=c[g][3]>=3?1:0,I=c[g][0]>=2?1:0,J=c[g][1]>=2?1:0,K=c[g][2]>=2?1:0,_=c[g][3]>=2?1:0,q=c[g][0]>=1?1:0,G=c[g][1]>=1?1:0,L=c[g][2]>=1?1:0,r0=c[g][3]>=1?1:0;const i0=n-T+e,c0=r-A+e,l0=l-B+e,a0=a-H+e,h0=n-I+2*e,d0=r-J+2*e,m0=l-K+2*e,p0=a-_+2*e,f0=n-q+3*e,u0=r-G+3*e,g0=l-L+3*e,M0=a-r0+3*e,x0=n-1+4*e,k0=r-1+4*e,y0=l-1+4*e,j0=a-1+4*e,Q=F&255,R=P&255,U=p&255,V=f&255,F0=s[Q+s[R+s[U+s[V]]]]%32,P0=s[Q+T+s[R+A+s[U+B+s[V+H]]]]%32,_0=s[Q+I+s[R+J+s[U+K+s[V+_]]]]%32,q0=s[Q+q+s[R+G+s[U+L+s[V+r0]]]]%32,G0=s[Q+1+s[R+1+s[U+1+s[V+1]]]]%32;let $=.6-n*n-r*r-l*l-a*a;$<0?j=0:($*=$,j=$*$*this.dot4(m[F0],n,r,l,a));let t0=.6-i0*i0-c0*c0-l0*l0-a0*a0;t0<0?b=0:(t0*=t0,b=t0*t0*this.dot4(m[P0],i0,c0,l0,a0));let s0=.6-h0*h0-d0*d0-m0*m0-p0*p0;s0<0?E=0:(s0*=s0,E=s0*s0*this.dot4(m[_0],h0,d0,m0,p0));let o0=.6-f0*f0-u0*u0-g0*g0-M0*M0;o0<0?u=0:(o0*=o0,u=o0*o0*this.dot4(m[q0],f0,u0,g0,M0));let e0=.6-x0*x0-k0*k0-y0*y0-j0*j0;return e0<0?M=0:(e0*=e0,M=e0*e0*this.dot4(m[G0],x0,k0,y0,j0)),27*(j+b+E+u+M)});for(let t=0;t<256;t++)this.p[t]=Math.floor(D.random()*256);for(let t=0;t<512;t++)this.perm[t]=this.p[t&255]}}const I0={title:"PointClouds",component:E0};let v0=new X0;const Y0=z=>{const{tfs:D,items:t,hulls:o,lines:i,texts:d,points:m,...c}=z;return L0.exports.useEffect(()=>{C0.setState({tfs:D,items:t,hulls:o,lines:i,texts:d,points:m})},[D,t,o,i,d,m]),S0(A0,{FallbackComponent:B0,children:S0("div",{style:{height:"calc(100vh - 2rem)",width:"calc(100vw - 2rem)"},children:S0(E0,{...c,store:C0,meshLookup:D0})})})},n0=Y0.bind({});n0.args={tfs:{movingFrame:{frame:"world",position:{x:z=>Math.cos(z/1e3),y:z=>Math.sin(z/1e3),z:0},rotation:{w:1,x:0,y:0,z:0},scale:{x:1,y:1,z:1}}},items:{},lines:{},hulls:{},texts:{},points:{pointCloud:{frame:"movingFrame",scale:1,points:T0.exports.range(0,5e3).map(()=>{const z=Math.random()*5,D=Math.random()*5,t=Math.random()*5;return{position:{x:o=>z-2.5+v0.noise(z*10,o/1e3),y:o=>D-2.5+v0.noise(D*10,o/1e3),z:o=>t-2.5+v0.noise(t*10,o/1e3)},color:{r:Math.round(Math.random()*255),g:Math.round(Math.random()*255),b:Math.round(Math.random()*255)}}})}},displayTfs:!0,displayGrid:!0,isPolar:!1,backgroundColor:"#d0d0d0",planeColor:"#a8a8a8",highlightColor:"#ffffff",plane:-.75,fov:60,ar:!1,vr:!1,onPointerMissed:()=>console.log("Missed Click")};var w0,b0,z0;n0.parameters={...n0.parameters,docs:{...(w0=n0.parameters)==null?void 0:w0.docs,source:{originalSource:`args => {
  const {
    tfs,
    items,
    hulls,
    lines,
    texts,
    points,
    ...otherArgs
  } = args;
  useEffect(() => {
    useDefaultSceneStore.setState({
      tfs,
      items,
      hulls,
      lines,
      texts,
      points
    });
  }, [tfs, items, hulls, lines, texts, points]);
  return <ErrorBoundary FallbackComponent={ErrorFallback}>
      <div style={{
      height: "calc(100vh - 2rem)",
      width: "calc(100vw - 2rem)"
    }}>
        <Scene {...otherArgs} store={useDefaultSceneStore} meshLookup={MeshLookupTable} />
      </div>
    </ErrorBoundary>;
}`,...(z0=(b0=n0.parameters)==null?void 0:b0.docs)==null?void 0:z0.source}}};const J0=["PointClouds"];export{n0 as PointClouds,J0 as __namedExportsOrder,I0 as default};
//# sourceMappingURL=PointCloud.stories.0adc0c5d.js.map
